import{T as f}from"./TemplateSetup-DmMsZDer.js";import{_ as w,c as v,w as r,r as u,o as a,b as o,e as d,f as p,a as c,v as m,F as b,g as y,t as k,d as g}from"./index-XFgfkqT_.js";import"./UtilityNavbar-CzfCgum_.js";import"./TemplateDefault-BCs3i3Pq.js";const x={components:{TemplateSetup:f},inject:["io","server","user","userUpdate"],data:()=>({email:"",password:"",providers:[]}),async created(){await this.getLoginProviders()},async mounted(){var t,e;(e=(t=this.$refs)==null?void 0:t.username)==null||e.focus()},methods:{async redirect(t){let e=this.server;(e==="/"||!e)&&(e=location.origin);const n=e.endsWith("/")?`oauth/${t}`:`/oauth/${t}`;location.href=e+n+`?app_url=${location.origin}`},async getLoginProviders(){try{await this.io.logout(),this.providers=await this.io.service("oauth_login").find()}catch(t){console.log("error",t)}},async login(t){this.io.authenticate({strategy:"local",...t}).then(e=>{this.userUpdate(e==null?void 0:e.user),this.$router.push("/dashboard")}).catch(e=>{console.error("Authentication error",e),alert(e.message)})}}},$=["onClick"];function T(t,e,n,_,L,l){const i=u("router-link"),h=u("TemplateSetup");return a(),v(h,null,{default:r(()=>[e[5]||(e[5]=o("h2",{class:"mb-2"}," JSTune ",-1)),d(o("input",{ref:"username","onUpdate:modelValue":e[0]||(e[0]=s=>t.email=s),class:"mb-3 font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Username"},null,512),[[m,t.email]]),d(o("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>t.password=s),class:"font-extralight text-slate-800 py-2.5 px-2 rounded-md w-full",placeholder:"Password",type:"password"},null,512),[[m,t.password]]),o("button",{onClick:e[2]||(e[2]=s=>l.login({email:t.email,password:t.password})),class:"hover:bg-fuchsia-950 mt-4 mb-2 rounded-lg bg-fuchsia-900 w-full p-3"}," Login "),(a(!0),p(b,null,y(t.providers,s=>(a(),p("button",{onClick:S=>l.redirect(s),class:"hover:bg-sky-800 bg-sky-700 mt-2 rounded-lg w-full p-3"}," Login with "+k(s),9,$))),256)),c(i,{to:"/recover",class:"hover:text-slate-200 mt-6 inline-block text-center w-full"},{default:r(()=>e[3]||(e[3]=[g(" Recover lost password ")])),_:1,__:[3]}),c(i,{to:"/register",class:"mt-3 hover:text-slate-200 inline-block text-center w-full"},{default:r(()=>e[4]||(e[4]=[g(" Request access ")])),_:1,__:[4]})]),_:1,__:[5]})}const N=w(x,[["render",T]]);export{N as default};
