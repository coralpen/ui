import{W as x}from"./UtilityNavbar-CzfCgum_.js";import v from"./TemplateDefault-BCs3i3Pq.js";import{S as b}from"./SectionHero-C_f05kHS.js";import{_ as g,c as w,w as a,r as n,o as y,a as u,b as s,e as d,t as m,v as f,j as T}from"./index-XFgfkqT_.js";const $={components:{WrapperPage:x,TemplateDefault:v,SectionHero:b},inject:["io"],props:["renderer"],data:()=>({command:"",address:"",output:"",autoscroll:!0,listener:null}),async created(){try{await this.inspectLeader()}catch{}console.log("Listening to terminal events"),this.listener=t=>{var e;(e=this.$refs)!=null&&e.output?(this.output+=`${t}
`,this.autoscroll&&setTimeout(()=>{this.$refs.output.scrollTop=this.$refs.output.scrollHeight},10)):this.io.service("terminal").off("output",this.listener)},this.io.service("terminal").on("output",this.listener)},beforeUnmount(){console.log("Unmount terminal"),this.io.service("terminal").off("output",this.listener)},methods:{async inspectLeader(){var e;const t=await this.io.service("state").get();if(t.leaderIP)this.address=t.leaderIP;else{const l=await this.io.service("docker_nodes").find({query:{leader:!0}}),r=(e=l==null?void 0:l.data)==null?void 0:e[0];r&&(this.address=r.address)}},async submit(){try{const t=await this.io.service("exec").patch({command:this.command});console.log("result",t),this.command=""}catch(t){alert(t.message)}}}},k={class:"flex-col max-w-md place-self-center mt-8 mb-24 w-full flex md:max-w-4xl"},D={class:"px-4 mb-4 mt-2 font-medium text-xl w-full"},P={class:"mt-6 relative mb-16 flex-col md:flex-row flex w-full"};function S(t,e,l,r,C,i){const c=n("SectionHero"),p=n("WrapperPage"),h=n("TemplateDefault");return y(),w(h,{renderer:l.renderer},{default:a(()=>[u(c,null,{default:a(()=>e[5]||(e[5]=[s("h1",{class:"font-thin text-xl lg:text-3xl xl:pl-6 w-full text-center"}," Terminal ",-1)])),_:1,__:[5]}),u(p,{class:"flex-col"},{default:a(()=>[s("div",k,[e[7]||(e[7]=s("h1",{class:"px-4 mb-2 mt-6 font-medium text-3xl w-full"}," Execute scripts on leader node ",-1)),s("h1",D," Leader node address: "+m(t.address),1),s("div",P,[d(s("textarea",{ref:"output",readonly:"","onUpdate:modelValue":e[0]||(e[0]=o=>t.output=o),class:"justify-start flex-col-reverse flex overflow-auto h-64 w-full p-4 rounded bg-slate-50",style:{"font-family":"monospace"}},null,512),[[f,t.output]]),e[6]||(e[6]=s("div",{class:"-mb-6 bg-slate-100 -bottom-5 absolute h-0.5 left-2 right-2"},null,-1))]),d(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.command=o),onKeypress:e[2]||(e[2]=T(o=>i.submit(),["enter"])),class:"p-4 my-4 bg-slate-50 rounded"},null,544),[[f,t.command]]),s("button",{class:"p-4 rounded bg-slate-200",onClick:e[3]||(e[3]=o=>i.submit())}," Go "),s("button",{class:"p-4 rounded bg-slate-200 my-4",onClick:e[4]||(e[4]=o=>t.autoscroll=!t.autoscroll)}," Autoscroll "+m(t.autoscroll?"on":"off"),1)])]),_:1})]),_:1},8,["renderer"])}const W=g($,[["render",S]]);export{W as default};
